<head>
    <!DOCTYPE html>
    <html lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/home.css">
    <title>Document</title>

    <!--Icons-->
    <link rel="stylesheet" href="fa/css/brands.css" />
    <link rel="stylesheet" href="fa/css/solid.css" />
    <link rel="stylesheet" href="fa/css/fontawesome.css" />
    <link rel="stylesheet" href="fa/css/regular.css" />
    <link rel="stylesheet" href="fa/css/all.css" />

<body>
    <div class="main">
        <!-- Top Navigation-->
        <nav>
            <div class="logo">
                <img src="img/logo2.png" alt="Logo is here">
            </div>
            <div class="links">
                <ul>
                    <li><a href="home.html">Home</a></li>
                    <li><a href="#">About</a></li>
                </ul>
            </div>
            <div class="menu">
                <ul>
                    <li><a href="#">INTEGRITY</a></li>
                    <li><a href="#">FAIRNESS</a></li>
                    <li><a href="#">SERVICE</a></li>
                    <li><a href="profile.html"><i class="fas fa-user"></i></a></li>
                </ul>
            </div>
            <div class="abt">
            </div>
        </nav>
        <main>
            <aside>
                <ul>
                    <li><a href="compose.html"> <img style="width: 25px; height: 25px;"
                                src="RemixIcon-2.5.0/icons/Design/pencil-line.svg"> Compose</a></li>
                    <li><a href="inbox.html"> <img style="width: 25px; height: 25px;"
                                src="RemixIcon-2.5.0/icons/Business/mail-line.svg"> Inbox</a></li>
                    <li><a href="sent.html"> <img style="width: 25px; height: 25px;"
                                src="RemixIcon-2.5.0/icons/Business/send-plane-line.svg"> Sent</a></li>
                    <li><a href="starred.html"> <img style="width: 25px; height: 25px;"
                                src="RemixIcon-2.5.0/icons/System/star-line.svg"> Starred</a></li>
                    <li><a href="drafts.html"> <img style="width: 25px; height: 25px;"
                                src="RemixIcon-2.5.0/icons/Document/draft-line.svg"> Drafts</a></li>
                    <li><a href="settings.html"> <img style="width: 25px; height: 25px;"
                                src="RemixIcon-2.5.0/icons/System/settings-line.svg"> Settings</a></li>
                </ul>
            </aside>
            <section class="p1">
                <div class="row">
                    <div class="column4">
                        <div class="card">
                            <h1 id="numOfInbox">...</h1>
                            <h3>Inbox</h3>
                            <p>Number of Inbox Memos</p>
                        </div>
                    </div>

                    <div class="column4">
                        <div class="card">
                            <h1 id="numOfSent">...</h1>
                            <h3>Sent</h3>
                            <p>Number of Sent Memos</p>
                        </div>
                    </div>

                    <div class="column4">
                        <div class="card">
                            <h1>0</h1>
                            <h3>Starred</h3>
                            <p>Number of Starred Memos</p>
                        </div>
                    </div>

                    <div class="column4">
                        <div class="card">
                            <h1>0</h1>
                            <h3>Drafts</h3>
                            <p>Number of Drafted Memos</p>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 50px;" class="row">
                    <div class="column3">
                        <div class="card">
                            <a href="compose.html">
                                <img alt="" width="25px" height="30px" style="margin-top: 8px 0;"
                                    src="RemixIcon-2.5.0/icons/Design/pencil-line.svg">
                                <h1>Compose</h1>
                            </a>
                        </div>
                    </div>
                    <div class="column3">
                        <div class="card">
                            <a href="inbox.html"> <img alt="" width="25px" height="30px" style="margin-top: 8px 0;"
                                    src="RemixIcon-2.5.0/icons/Business/mail-line.svg">
                                <h1>Inbox</h1>
                            </a>
                        </div>
                    </div>
                    <div class="column3">
                        <div class="card">
                            <a href="sent.html">
                                <img alt="" width="25px" height="30px" style="margin-top: 8px 0;"
                                    src="RemixIcon-2.5.0/icons/Business/send-plane-line.svg">
                                <h1>Sent</h1>
                            </a>
                            </a>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 50px;" class="row">
                    <div class="column3">
                        <div class="card">
                            <a href="starred.html"> <img alt="" width="25px" height="30px" style="margin-top: 8px 0;"
                                    src="RemixIcon-2.5.0/icons/System/star-line.svg">
                                <h1>Starred</h1>
                            </a>
                        </div>
                    </div>
                    <div class="column3">
                        <div class="card">
                            <a href="drafts.html"> <img alt="" width="25px" height="30px" style="margin-top: 8px 0;"
                                    src="RemixIcon-2.5.0/icons/Document/draft-line.svg">
                                <h1>Drafts</h1>
                            </a>
                        </div>
                    </div>
                    <div class="column3">
                        <div class="card">
                            <a href="settings.html"> <img alt="" width="25px" height="30px" style="margin-top: 8px 0;"
                                    src="RemixIcon-2.5.0/icons/System/settings-line.svg">
                                <h1>Settings</h1>
                            </a>
                        </div>
                    </div>
                </div>
            </section>
        </main>
        <script>
            // Get the composed memo from he local storage
            const authUser = JSON.parse(localStorage.getItem('authUser'));
        </script>
        <script type="module">

            // Import the functions you need from the SDKs you need
            import { db } from "./js/firebase.js";
            import { collection, query, where, onSnapshot } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-firestore.js";

            // Get the email list element
            // const memoList = document.getElementById('numOfMemo');

            const sentQuerry = query(collection(db, "memo"), where("from", "==", authUser.department));
            const inboxQuerry = query(collection(db, "memo"), where("to", "==", authUser.department));

            Promise.all([onSnapshot(sentQuerry, (querySnapshot) => {
                console.log(querySnapshot.length);
                document.getElementById('numOfInbox').textContent = querySnapshot.docs.length;
            }), onSnapshot(inboxQuerry, (querySnapshot) => {
                console.log(querySnapshot.length);
                document.getElementById('numOfSent').textContent = querySnapshot.docs.length;
            })]).then(values => {
                console.log(values); // [3, 1337, "foo"] 
            });

        </script>
</body>

</html>